1:
  status: unknown
  argument:
    - The @EnableZuulProxy annotation is present,
    - No evidence of separate access to authorization server,
    - Authorization server route in YML of API Gateway
    - only file in whole repository is the main class and there is no @EnableResourceServer annotation -> no authorization at gateway
  artifacts:
    - file: gateway/src/main/java/com/piggymetrics/gateway/GatewayApplication.java
      lines: [10]
    - file: config/src/main/resources/shared/gateway.yml
      lines: [13, 45]

2:
  status: observed
  argument: 
    - The @EnableResourceServer annotation is present at every downstream service > tokens are required for incoming requests for authorization even between requests between services
    - Tokens need specific scope to be accepted
  artifacts:
    - file: account-service/src/main/java/com/piggymetrics/account/config/ResourceServerConfig.java
      lines: [23]
    - file: auth-service/src/main/java/com/piggymetrics/auth/AuthApplication.java
      lines: [10]
    - file: notification-service/src/main/java/com/piggymetrics/notification/config/ResourceServerConfig.java
      lines: [18]
    - file: statistics-service/src/main/java/com/piggymetrics/statistics/config/ResourceServerConfig.java
      lines: [15]
    - file: statistics-service/src/main/java/com/piggymetrics/statistics/controller/StatisticsController.java
      lines: [25]

3:
  status: unknown
  argument:
    - The @EnableAuthorizationServer annotation is present
    - No JwtAccessTokenConverter -> Opaque Tokens
    - Endpoint for validating user in tokens present
  artifacts:
    - file: auth-service/src/main/java/com/piggymetrics/auth/config/OAuth2AuthorizationConfig.java
      lines: [22]
    - file: auth-service/src/main/java/com/piggymetrics/auth/controller/UserController.java
      lines: [27]

4:
  status: unknown
  argument: Identity representations (opaque token) are used at all downstream services and between services for authorization due to @EnableResourceServer annotation, however no indication of a transformation present (see Rule 2 arguments).

5:
  status: observed
  argument:
    - Endpoint for validating is there per Rule 3 in the Authorization Server,
    - Endpoint is listed under "security.oauth2.resource.user-info-uri" in application.yml at the config-server,
    - See Rule 3 argumentation.
  artifacts:
    - file: config/src/main/resources/shared/application.yml
      lines: [23]

6:
  status: disregarded
  argument: There is no functionality present that enforcecs any consequences for a specific amount of failed login attempts

7:
  status: disregarded
  argument:
    - There are no certificates in the repository and no "server.ssl.key-store"/"server.ssl.trust-store" arguments inserted in the yml of the API gateway.
    - The "server.ssl.enabled" is set, but only in test-suite YML-Configurations
  artifacts:
    - file: config/src/main/resources/shared/gateway.yml

8:
  status: disregarded
  argument: See Rule 7 argumentation.
  artifacts:
    - file: config/src/main/resources/shared/gateway.yml

9:
  status: disregarded
  argument: The README.md mentions centralized logging with elasticsearch, but there is no artifact in the repository to confirm.
  artifacts:
    - file: README.md
      lines: [192]

10:
  status: disregarded
  argument: No central logging system is deployed.

11:
  status: disregarded
  argument: Logs are not explicitly sanitized.

12:
  status: disregarded
  argument: No message broker is deployed and no logs are collected.

13:
  status: observed
  argument: Hystrix is deployed as a circuit breaker on the gateway server with the @EnableZuulProxy annotation.
  artifacts:
    - file: gateway/src/main/java/com/piggymetrics/gateway/GatewayApplication.java
      lines: [10]
    - file: account-service/src/main/java/com/piggymetrics/account/AccountApplication.java
      lines: [15]

14:
  status: observed
  argument: The gateway server uses load balancing via Ribbon to access dependent services.
  artifacts:
    - file: gateway/src/main/java/com/piggymetrics/gateway/GatewayApplication.java
      lines: [10]

15:
  status: not applicable
  argument: Not a service mesh deployment.

16:
  status: observed
  argument:
    - Registry Service (Eureka Server) present with @EnableEurekaServer annotation.
    - Eureka Server deployed in Docker Compose -> able to start on dedicated server
  artifacts:
    - file: registry/src/main/java/com/piggymetrics/registry/RegistryApplication.java
      lines: [8]
    - file: docker-compose.yml
      lines: [23]

17:
  status: disregarded
  argument: No HTTP basic password listed in any YML-Configuration of format username:password@here-location-of-eureka-server at "eureka.client.serviceUrl.defaultZone".
  artifacts:
    - file: config/src/main/resources/shared/application.yml
      lines: [13]

18:
  status: disregarded
  argument: No secret manager is deployed.
